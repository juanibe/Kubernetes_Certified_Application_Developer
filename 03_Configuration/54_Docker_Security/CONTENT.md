# DOCKER SECURITY

A host with docker installed on it has a set of own processes such as a number of O.S processes, the docker deamon itself, the ssh server, etc... Unlike V.M's containers are not completely isolated from their host. They share the same _kernel_. Containers are isolated using namespaces in linux. The host has a namespace and the container has its own namespace. All the processes run by the containers are in fact run by host itself but in their own namespace. As far as the docker container is concerned it is in its own namespace and can see its own processes only. It can not see anything outside of it or in any other namespace. So when you list the processes from withing the docker container, you can see the process with the process id. For the docker host all processes of its own as well as those in the child namespaces are visibles as just another process in the system. So when you list the processes on the host (`ps aux`) you see a list of processes including the one in docker but with a different process id. That is because processes can have different processes ids in different namespaces and that's how docker isolates containers within a system. That's process isolation.

### Users (security)

The docker host has a set of users: A _root_ one and a set of _non root_ users. By default docker run processes within containers as the root user. If you don't want to be run as the root user, you can specify it setting the _user_ option withing the _docker run_ command and specify the new user id: `docker run --user=1000 ubuntu sleep 3600`. Another way to enforce user security is to have that defined in the docker image itself at the time of creation (see file _Dockerfile_)

**What happens when you run containers as a root user?**: Are the users of the container and host the same?. Docker implement a set of security features that limits the ability of the root user within the container. So the root user within the container isn't really like the root user on the host. Docker uses linux capabilities to implement this.
A root user can do anything, and so a process run by the root user. It has unrestricted access to the system, from modifying files and permissions on files, access control, creating or killing processes, setting group ID or user ID, performing network related operations, such as binding to network ports, broadcasting on a network, controlling network ports and many more. (you can see a full list of capabilities at the location `usr/include/linux/capability.h`). By default docker runs the container with a limited set of capabilities and so the processes running withing the container do not have the privileges to say for instance _reboot the host_ or perform operations that can disrupt the host or other containers running on the same host. If you want to override this behaviour and provide additional privileges than that is available use the _cap-add_ option in the _docker run_ command: `docker run --cap-add MAC_ADMIN ubuntu`. In a similar way you can _drop_ privileges using the _cap-drop_ option or if you wish to run the container with all privileges enabled, use the `--privileged` flag.
